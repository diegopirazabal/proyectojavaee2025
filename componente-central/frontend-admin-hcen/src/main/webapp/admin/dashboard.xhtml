<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
    <title>HCEN - Dashboard Administrativo</title>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" type="text/css" href="#{request.contextPath}/resources/css/dashboard.css"/>
</h:head>

<h:body>
    
    <f:metadata>
        <f:event type="preRenderView" listener="#{loginBean.checkAuthentication}"/>
    </f:metadata>

    <div class="dashboard-container">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <div class="logo-section">
                    <h1>HCEN</h1>
                    <span>Portal Administrativo</span>
                </div>
                
                <div class="user-section">
                    <p:outputPanel rendered="#{loginBean.loggedIn}">
                        <span class="welcome-text">Bienvenido, #{loginBean.loggedAdmin.fullName}</span>
                        <h:form style="display: inline;">
                            <p:commandButton value="Cerrar Sesión" 
                                           action="#{loginBean.logout}"
                                           styleClass="logout-button"
                                           icon="pi pi-sign-out"/>
                        </h:form>
                    </p:outputPanel>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="dashboard-main">
            <div class="dashboard-content">
                
                <h:form id="dashboardForm">
                    <p:messages id="messages" showDetail="true" closable="true"/>
                    
                    <!-- Dashboard Cards -->
                    <div class="dashboard-grid">
                        
                        <!-- Admin Info Card -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3><i class="pi pi-user"></i> Información del Administrador</h3>
                            </div>
                            <div class="card-content">
                                <p><strong>Usuario:</strong> #{loginBean.loggedAdmin.username}</p>
                                <p><strong>Nombre:</strong> #{loginBean.loggedAdmin.fullName}</p>
                                <p><strong>Email:</strong> #{loginBean.loggedAdmin.email}</p>
                                <p><strong>Estado:</strong> 
                                    <span class="status-active">#{loginBean.loggedAdmin.active ? 'Activo' : 'Inactivo'}</span>
                                </p>
                                <p><strong>Último acceso:</strong> 
                                    <h:outputText value="#{loginBean.loggedAdmin.lastLogin}" 
                                                 rendered="#{loginBean.loggedAdmin.lastLogin != null}">
                                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                                    </h:outputText>
                                    <span rendered="#{loginBean.loggedAdmin.lastLogin == null}">Primer acceso</span>
                                </p>
                            </div>
                        </div>
                        
                        <!-- System Status Card -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3><i class="pi pi-cog"></i> Estado del Sistema</h3>
                            </div>
                            <div class="card-content">
                                <p><strong>INUS:</strong> <span class="status-active">Operativo</span></p>
                                <p><strong>RNDC:</strong> <span class="status-active">Operativo</span></p>
                                <p><strong>Base de Datos:</strong> <span class="status-active">Conectada</span></p>
                                <p><strong>Servicios Web:</strong> <span class="status-active">Disponibles</span></p>
                            </div>
                        </div>
                        
                        <!-- Quick Actions Card -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3><i class="pi pi-bolt"></i> Acciones Rápidas</h3>
                            </div>
                            <div class="card-content">
                                <p:commandButton value="Gestionar Clínicas" 
                                               styleClass="action-button"
                                               icon="pi pi-building"/>
                                <br/><br/>
                                <p:commandButton value="Ver Reportes" 
                                               styleClass="action-button"
                                               icon="pi pi-chart-bar"/>
                                <br/><br/>
                                <p:commandButton value="Configuración" 
                                               styleClass="action-button"
                                               icon="pi pi-cog"/>
                            </div>
                        </div>
                        
                        <!-- Statistics Card -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3><i class="pi pi-chart-line"></i> Estadísticas</h3>
                            </div>
                            <div class="card-content">
                                <p><strong>Usuarios INUS:</strong> 1,250</p>
                                <p><strong>Documentos RNDC:</strong> 5,680</p>
                                <p><strong>Clínicas Registradas:</strong> 23</p>
                                <p><strong>Accesos Hoy:</strong> 145</p>
                            </div>
                        </div>
                        
                    </div>
                </h:form>
                
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="dashboard-footer">
            <p>© 2025 HCEN - Historia Clínica Electrónica Nacional - Universidad de la República</p>
        </footer>
        
    </div>

</h:body>
</html>